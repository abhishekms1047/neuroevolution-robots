<html>

<body>
    <script src="https://cdn.jsdelivr.net/npm/planck-js@0.2/dist/planck-with-testbed.js"></script>
    <!-- Libraries -->
    <script src="lib/tf.js"></script>
    <!-- NeuroEvolution -->
    <script src="./nn.js"></script>
    <script src="./ga.js"></script>
    <!-- <script src="./ga.js"></script> -->
    <script src="./ragdoll.js"></script>
    <script>
        planck.testbed('Pinball', function (testbed) {
            var pl = planck, Vec2 = pl.Vec2;
            var world = new pl.World(Vec2(0, -10));
            
            const sceneSize = 1;

            const pt1 = Vec2(-40.0, -15.0);
            const pt2 = Vec2(40.0, -15.0);
            const pt3 = Vec2(pt1.x, pt1.y+sceneSize*10);
            const pt4 = Vec2(pt2.x, pt2.y + sceneSize*10);
            world.createBody().createFixture(pl.Edge(pt1, pt2));
            world.createBody().createFixture(pl.Edge(pt1, pt3));
            world.createBody().createFixture(pl.Edge(pt2, pt4));
            world.vtcl = {min: pt1.y, max: pt3.y };
            world.hztl = { min: pt1.x+sceneSize*5, max: pt2.x-sceneSize*5 };

            let generation = new Generation(world, 10);
            generation.initialize(Ragdoll, sceneSize);

            // const ragdollInitY = (world.vtcl.max + world.vtcl.min)/2;

            // const rdoll = new Ragdoll(world,sceneSize,0, ragdollInitY);
            // rdoll.start();
            // rdoll.rot();
            // const rdoll2 = new Ragdoll(world, sceneSize, 5, 0);
            // rdoll2.start();

            testbed.step = function () {
                // rdoll.rot()
                // box1.applyAngularImpulse(-100);
                // console.log(mouse.getPosition())
            }


            return world;
        });
    </script>
</body>

</html>